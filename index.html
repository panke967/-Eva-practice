<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>æ¬¢è¿æ¥åˆ°Evaçš„ç»ƒä¹ å°è¯¾å ‚ / Bienvenidos al mini-aula de prÃ¡ctica de Eva</title>
<style>
/* å…¨å±€æ ·å¼ï¼šç»Ÿä¸€å­—ä½“ä¸º Times New Romanï¼Œç®€æ´å­¦ä¹ é£ */
* { margin: 0; padding: 0; box-sizing: border-box; }

body{
  background:#fff9e6;
  font-family: "Times New Roman", serif; /* å…¨å±€å­—ä½“ç»Ÿä¸€ä¸º Times New Roman */
  color:#333;
  padding:20px;
  margin:0;
}

h1,h2{text-align:center;margin:15px 0;}
h1{color:#d2691e;font-size:24px;}
h2{color:#333;font-size:20px;}

/* æ ‡é¢˜æ ·å¼ï¼šè¿˜åŸåŸå§‹æ–‡æœ¬ï¼Œå­—ä½“ä¿æŒ Times New Roman */
.page-title {
  text-align: center;
  color: #d2691e;
  font-size: 28px;
  margin-bottom: 8px;
  font-family: "Times New Roman", serif;
}
.page-subtitle {
  text-align: center;
  color: #666;
  font-size: 18px;
  margin-bottom: 30px;
  font-weight: normal;
  font-family: "Times New Roman", serif;
}

/* æ¿å—æ ·å¼ */
.section {
  max-width: 1000px;
  margin: 0 auto 30px;
  padding: 25px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  transition: box-shadow 0.3s ease;
  min-height: 200px; /* å…³é”®ï¼šåˆå§‹çŠ¶æ€ä¸‹æ‰€æœ‰æ¿å—æœ€å°é«˜åº¦ä¸€è‡´ */
}
.section:hover { box-shadow: 0 4px 15px rgba(0,0,0,0.12); }
.section-title {
  color: #333;
  font-size: 20px;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #f0f0f0;
  font-family: "Times New Roman", serif;
}

/* æŒ‰é’®æ ·å¼ï¼šå­—ä½“ç»Ÿä¸€ä¸º Times New Roman */
.btn {
  display: inline-block;
  padding: 12px 24px;
  background: #ffd27f;
  border: none;
  border-radius: 8px;
  color: #333;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: "Times New Roman", serif;
}
.btn:hover {
  background: #ffc04d;
  transform: translateY(-2px);
}
.btn:active { transform: translateY(0); }

/* é˜…è¯»å†…å®¹æ ·å¼ï¼šè¥¿è¯­å•è¯å­—ä½“ç¡®ä¿ä¸º Times New Roman */
.reading-container { position: relative; }
.reading-content {
  font-size: 17px;
  line-height: 2.2;
  padding-left: 20px;
  margin-top: 25px;
  font-family: "Times New Roman", serif;
}

/* éŸ³ä¹æ§åˆ¶å™¨ */
#musicBtn {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: none;
  background: #ffd27f;
  color: #fff;
  font-size: 22px;
  cursor: pointer;
  box-shadow: 0 3px 8px rgba(0,0,0,0.15);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
  transition: all 0.3s ease;
  font-family: "Times New Roman", serif;
}
#musicBtn:hover {
  background: #ffc04d;
  transform: scale(1.05);
}
</style>
</head>
<body>
<!-- é¡µé¢æ ‡é¢˜ï¼šä¸¥æ ¼è¿˜åŸåŸå§‹æ–‡æœ¬ï¼Œæœªåšä»»ä½•ä¿®æ”¹ -->
<h1>æ¬¢è¿æ¥åˆ°Evaçš„ç»ƒä¹ å°è¯¾å ‚</h1>
<h1>Bienvenidos al mini-aula de prÃ¡ctica de Eva</h1>

<!-- éŸ³ä¹æ§åˆ¶å™¨ -->
<button id="musicBtn" title="æ’­æ”¾/æš‚åœ">â–¶</button>
<audio id="bgMusic" loop>
  <source src="river-flows-in-you.mp3" type="audio/mpeg">
  Tu navegador no soporta el audio.
</audio>

<!-- é˜…è¯»ç»ƒä¹ æ¿å—ï¼ˆæ ¸å¿ƒï¼‰ -->
<div class="section">
  <h3 class="section-title">ğŸ“– é˜…è¯»-å•è¯å¼ºåŒ–å¤ä¹ </h3>
  <button id="refreshBtn" class="btn">è¿›å…¥é˜…è¯»ç»ƒä¹ </button>

<!-- é˜…è¯»å†…å®¹å®¹å™¨ -->
  <div class="reading-container">
    <div class="reading-content" id="lectura"></div>
  </div>
</div>


<!-- âœï¸ å¬å†™-å•è¯ç†Ÿæ‚‰å¤ä¹  -->
<div class="section">
  <h3 class="section-title">âœï¸ å¬å†™-å•è¯ç†Ÿæ‚‰å¤ä¹ </h3>
  <button id="dictadoStart" class="btn">è¿›å…¥å¬å†™ç»ƒä¹ </button>

  <!-- ç‚¹è¿›åæ˜¾ç¤ºçš„åŒºåŸŸ -->
<div id="dictadoBox" style="display:none;margin-top:15px;">
  <!-- æ–°å¢å±…ä¸­å®¹å™¨ï¼šè®©æç¤ºã€è¾“å…¥æ¡†ã€æŒ‰é’®éƒ½å±…ä¸­ -->
  <div style="display:flex;flex-direction:column;align-items:center;gap:15px;">
    <div id="dictadoPrompt" style="font-size:20px;color:#d93025;margin-bottom:10px;text-align:center;"></div>
    <!-- è¾“å…¥æ¡†+ç¡®å®šæŒ‰é’® å®¹å™¨ï¼ˆæ°´å¹³å±…ä¸­ï¼‰ -->
    <div style="display:flex;align-items:center;gap:10px;">
      <input id="dictadoInput" type="text" placeholder="è¯·è¾“å…¥è¥¿è¯­å•è¯" 
       style="padding:8px;width:260px;font-family:'Times New Roman',serif;border:none;border-bottom:2px solid #d93025;background:transparent;outline:none;">
      <button id="dictadoCheck" class="btn">ç¡®å®š</button>
    </div>
    <!-- ç»“æœæç¤ºï¼ˆå±…ä¸­æ˜¾ç¤ºï¼‰ -->
    <div id="dictadoResult" style="margin-top:10px;font-weight:bold;text-align:center;"></div>
    <!-- ä¸‹ä¸€ä¸ªæŒ‰é’®ï¼ˆå•ç‹¬ä¸€è¡Œï¼Œå±…ä¸­ï¼‰ -->
    <div style="margin-top:5px;">
      <button id="dictadoStart" class="btn" disabled>ä¸‹ä¸€ä¸ª</button>
    </div>
  </div>
</div>



<script>
// çŸ­æ–‡æ•°æ®ï¼šå®Œå…¨æ›¿æ¢ä¸ºä½ æä¾›çš„12ç¯‡çŸ­æ–‡
const textosFijos = [
  // çŸ­æ–‡1
  "Susana es de PerÃº, de Lima. Ella estÃ¡ en Madrid con su familia. Hoy ella no va al campus. Ella y su hermano mayor desayunan cafÃ© y leche. Su hermano trabaja en el banco. Ellos se levantan tarde. Por la noche, salen a conocer la ciudad.",

  // çŸ­æ–‡2
  "Mi amigo Juan vive en una casa grande. Ã‰l tiene dos habitaciones. Por la tarde, Juan vuelve del instituto. Primero, Ã©l se cepilla los dientes en el cuarto de baÃ±o. Luego, su abuela prepara la cena. Nosotros comemos un poco de pan y carne con alegrÃ­a.",

  // çŸ­æ–‡3
  "Nosotros somos de China. Vivimos en este paÃ­s. Estudiamos lengua y cultura. Vemos la vida universitaria con alegrÃ­a. Hacemos muchos trabajos de casa. Cada dÃ­a es nuevo y volvemos a empezar.",

  // çŸ­æ–‡4
  "VÃ­ctor y Pablo organizan su horario. Ellos estÃ¡n muy ocupados. Leen la lecciÃ³n y repasan en la biblioteca. Salen del campus a las nueve. Ellos vienen a la residencia y duermen. Los aÃ±os de doctorado son apretados.",

  // çŸ­æ–‡5
  "Yo desayuno con mi familia. Mi hermana se peina despuÃ©s de desayunar. Luego vamos a la escuela juntos. Yo tomo el metro y ella toma el autobÃºs. Yo vuelvo a casa por la tarde. Preparo la cena sin descansar.",

  // çŸ­æ–‡6
  "Ustedes tienen que presentarse ante la clase. Dicen su nombre. Luego hablan de su paÃ­s. Todos escuchan bien. DespuÃ©s, el profesor hace preguntas. Aplaudimos y decimos ã€Šgraciasã€‹ al terminar.",

  // çŸ­æ–‡7
  "Mi familia vive en Lima. Mi hermano mayor estudia en la universidad. Mi hermana menor va a la escuela. Mi madre es profesora de inglÃ©s. Mi padre es mÃ©dico. Yo estoy aquÃ­ en Madrid, pero voy a volver en verano.",

  // çŸ­æ–‡8
  "Ellos vienen al comedor al mediodÃ­a. Almuerzan juntos. Hoy hablan de su paÃ­s. Ellos son latinoamericanos: uno es cubano y el otro es peruano. Terminan de comer a la una en punto y van a la biblioteca.",

  // çŸ­æ–‡9
  "â€”Â¿QuÃ© haces tÃº aquÃ­ por la maÃ±ana? <br> â€”Yo preparo mi doctorado. <br>â€”Â¿Por quÃ© vienes al campus? <br>â€”Porque quiero terminar antes del verano. <br>â€”Â¿EstÃ¡s contento con el horario? <br>â€”SÃ­, estoy contento, pero es muy apretado.",

  // çŸ­æ–‡10
  "Nosotros estudiamos lengua en la universidad. Vivimos en la residencia cerca del campus. Por la noche repasamos la lecciÃ³n. Queremos terminar el curso con alegrÃ­a. Hablamos de la vida en EspaÃ±a sin descansar mucho.",

  // çŸ­æ–‡11
  "Yo me llamo Ana. Soy estudiante de espaÃ±ol. Mi amigo Paco es chileno y es estudiante tambiÃ©n. Conocemos a un profesor de China. Decimosã€Šmucho gustoã€‹al profesor. Ã‰l es de China, pero vive aquÃ­.",

  // çŸ­æ–‡12
  "TomÃ¡s se levanta temprano por la maÃ±ana. Ã‰l desayuna en casa con su padre. Su padre trabaja en el hospital. DespuÃ©s, TomÃ¡s toma el autobÃºs para el instituto. Por la tarde, Ã©l vuelve a casa y hace la tarea."
];

// é¡µé¢æ ¸å¿ƒåŠŸèƒ½
const ReadingHandler = {
  init() {
  this.bindEvents();
},

  bindEvents() {
    // åˆ·æ–°çŸ­æ–‡æŒ‰é’®äº‹ä»¶ï¼šç‚¹å‡»åˆ‡æ¢12ç¯‡çŸ­æ–‡
    document.getElementById('refreshBtn').addEventListener('click', () => this.loadRandomText());
    // éŸ³ä¹æ§åˆ¶å™¨äº‹ä»¶
    document.getElementById('musicBtn').addEventListener('click', this.toggleMusic);
    // æ–°å¢ï¼šè¾“å…¥æ¡†å¤±ç„¦æ—¶ä¸æ‰§è¡Œåˆ¤æ–­
  document.getElementById('dictadoInput').addEventListener('blur', () => {
    // ä»€ä¹ˆéƒ½ä¸åšï¼Œç¡®ä¿åªæœ‰ç‚¹å‡»ç¡®å®šæ‰åˆ¤æ–­
    });
  },

  // åŠ è½½éšæœºçŸ­æ–‡ï¼ˆä»12ç¯‡ä¸­éšæœºé€‰æ‹©ï¼‰
  loadRandomText() {
    const randomIdx = Math.floor(Math.random() * textosFijos.length);
    const text = textosFijos[randomIdx];
    const lecturaDiv = document.getElementById('lectura');
    
    // æ˜¾ç¤ºæ–‡ç« å†…å®¹å¹¶ä¿ç•™å¯¹è¯æ ¼å¼
    lecturaDiv.innerHTML = text.replace(/â€”/g, '<span style="display: inline-block; margin: 0 5px;">â€”</span>');
    },

  // éŸ³ä¹æ’­æ”¾/æš‚åœæ§åˆ¶
toggleMusic() {
    const musicBtn = document.getElementById('musicBtn');
    const bgMusic = document.getElementById('bgMusic');
    const isPlaying = !bgMusic.paused;

    if (isPlaying) {
      bgMusic.pause();
      musicBtn.textContent = 'â–¶';
    } else {
      bgMusic.play().then(() => {
        musicBtn.textContent = 'âšâš';
      }).catch(err => {
        console.log('éŸ³ä¹æ’­æ”¾è¢«æ‹¦æˆªï¼š', err);
        alert('è¯·æ‰‹åŠ¨å…è®¸æµè§ˆå™¨æ’­æ”¾éŸ³é¢‘');
      });
    }
  }
};

</script>

<script>
/* ========== å¬å†™æ¨¡å—ï¼ˆä¿®å¤åå®Œæ•´ä»£ç ï¼‰ ========== */
const DictadoHandler = {
  palabras: [],
  idx: 0,
  correct: 0,
  total: 0,
  isChecked: false, // æ ‡è®°æ˜¯å¦å·²æ£€æŸ¥ç­”æ¡ˆ

  init() {
    this.cargarCSV();
    this.bindEvents();
  },

  async cargarCSV() {
    try {
      const texts = await Promise.all(
        ['1u1.csv', '1u2.csv', '1u3.csv', '1u4.csv'].map(async (u) => {
          const response = await fetch(u);
          if (!response.ok) throw new Error(`æ–‡ä»¶ ${u} åŠ è½½å¤±è´¥`);
          return response.text();
        })
      );
      texts.forEach(t => {
        const lines = t.trim().split('\n').slice(1);
        lines.forEach(l => {
          const [es, cn, pos] = l.split(/,|ï¼Œ/).map(s => s.replace(/^"|"$/g, '').trim());
          if (es && cn && pos) this.palabras.push({ es, cn, pos });
        });
      });
      if (this.palabras.length === 0) {
        alert('âš ï¸ æœªåŠ è½½åˆ°ä»»ä½•å•è¯ï¼Œè¯·æ£€æŸ¥CSVæ–‡ä»¶æ˜¯å¦æ­£ç¡®');
      }
    } catch (err) {
      alert('âŒ CSV åŠ è½½å¤±è´¥ï¼š' + err.message);
      console.error('CSV åŠ è½½é”™è¯¯ï¼š', err);
    }
  },

  bindEvents() {
    // ã€Œè¿›å…¥å¬å†™/ä¸‹ä¸€ä¸ªã€æŒ‰é’®äº‹ä»¶ï¼ˆæ ¸å¿ƒä¿®å¤ï¼‰
    const dictadoStartBtn = document.getElementById('dictadoStart');
    dictadoStartBtn.addEventListener('click', () => {
      const dictadoBox = document.getElementById('dictadoBox');
      if (dictadoBox.style.display === 'none' || dictadoBox.style.display === '') {
        // é¦–æ¬¡ç‚¹å‡»ï¼šæ˜¾ç¤ºå¬å†™åŒºåŸŸ + åŠ è½½ç¬¬ä¸€ä¸ªå•è¯
        dictadoBox.style.display = 'block';
        dictadoStartBtn.textContent = 'ä¸‹ä¸€ä¸ª';
        this.nuevaPalabra(); // ç›´æ¥åŠ è½½ç¬¬ä¸€ä¸ªå•è¯
      } else {
        // åç»­ç‚¹å‡»ï¼šåŠ è½½ä¸‹ä¸€ä¸ªå•è¯
        this.nuevaPalabra();
      }
    });

    // ã€Œç¡®å®šã€æŒ‰é’®äº‹ä»¶ï¼ˆåªæœ‰ç‚¹å‡»æ‰åˆ¤æ–­ï¼‰
    document.getElementById('dictadoCheck').addEventListener('click', () => {
      this.verificar();
    });

    // å¯é€‰ï¼šä¿ç•™å›è½¦é”®æäº¤ï¼ˆä¸éœ€è¦å¯åˆ æ‰ï¼‰
    document.getElementById('dictadoInput').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') this.verificar();
    });
  },

  nuevaPalabra() {
    if (this.palabras.length === 0) {
      alert('âš ï¸ æœªåŠ è½½åˆ°ä»»ä½•å•è¯');
      return;
    }

    // é‡ç½®çŠ¶æ€ï¼ˆå…³é”®ï¼šç¡®ä¿æŒ‰é’®æ­£å¸¸åˆ‡æ¢ï¼‰
    this.isChecked = false;
    const dictadoCheckBtn = document.getElementById('dictadoCheck');
    const dictadoStartBtn = document.getElementById('dictadoStart');
    dictadoCheckBtn.disabled = false; // å¯ç”¨ç¡®å®šæŒ‰é’®
    dictadoStartBtn.disabled = true; // ç¦ç”¨ä¸‹ä¸€ä¸ªæŒ‰é’®

    // éšæœºåŠ è½½å•è¯
    this.idx = Math.floor(Math.random() * this.palabras.length);
    const w = this.palabras[this.idx];
    document.getElementById('dictadoPrompt').innerHTML =
      `<span style="font-size:20px;color:#d93025;">${w.cn}</span>ã€€<span style="color:#666;">(${w.pos})</span>`;
    document.getElementById('dictadoInput').value = '';
    document.getElementById('dictadoResult').textContent = '';
    document.getElementById('dictadoInput').focus();
  },

  verificar() {
    // é˜²é‡å¤æäº¤ + ç©ºè¾“å…¥ä¸åˆ¤æ–­
    if (this.isChecked || !document.getElementById('dictadoInput').value.trim()) {
      return;
    }

    const input = document.getElementById('dictadoInput').value.trim().toLowerCase();
    const correct = this.palabras[this.idx].es.toLowerCase();
    const resBox = document.getElementById('dictadoResult');
    this.total++;

    if (input === correct) {
      this.correct++;
      resBox.innerHTML = `<span style="color:green;">âœ… æ­£ç¡®ï¼</span>`;
    } else {
      resBox.innerHTML = `<span style="color:red;">âŒ æ­£ç¡®å†™æ³•ï¼š${this.palabras[this.idx].es}</span>`;
    }

    // æ£€æŸ¥åçŠ¶æ€åˆ‡æ¢
    this.isChecked = true;
    document.getElementById('dictadoCheck').disabled = true; // ç¦ç”¨ç¡®å®š
    document.getElementById('dictadoStart').disabled = false; // å¯ç”¨ä¸‹ä¸€ä¸ª
  }
};

// åˆå¹¶åˆå§‹åŒ–äº‹ä»¶ï¼ˆç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡ï¼‰
window.addEventListener('DOMContentLoaded', () => {
  ReadingHandler.init();
  DictadoHandler.init();
});
</script>




</body>
</html>
